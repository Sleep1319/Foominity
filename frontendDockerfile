# frontendDockerfile  (프론트 전용)
FROM node:20-alpine AS build
WORKDIR /app
COPY package*.json ./
RUN npm ci
COPY . .

# 프론트에서 그대로 사용할 값(공개됨 주의)
ARG VITE_API_URL
ARG VITE_RAPIDAPI_HOST
ARG VITE_RAPIDAPI_KEY
ENV VITE_API_URL=$VITE_API_URL
ENV VITE_RAPIDAPI_HOST=$VITE_RAPIDAPI_HOST
ENV VITE_RAPIDAPI_KEY=$VITE_RAPIDAPI_KEY

RUN npm run build

FROM node:20-alpine
WORKDIR /app
RUN npm i -g http-server
COPY --from=build /app/dist ./dist
EXPOSE 5173
CMD ["http-server","dist","-p","5173"]